<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Ver Ficha</title>
  <link rel="icon" href="{{ url_for('static', filename='images/favicon.png') }}" type="image/png">
  <link rel="stylesheet" href="{{ url_for('static', filename='css/ver_fichas.css') }}">
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 text-gray-900">
  <div class="max-w-4xl mx-auto p-6 bg-white shadow-md rounded-lg my-8">
    
    <!-- Información básica del personaje (siempre visible) -->
    <div class="mb-6">
      <p class="mb-2"><span class="font-bold">Nombre del personaje:</span> {{ contenido['nombre'] }}</p>
      <p class="mb-2"><span class="font-bold">Nivel:</span> {{ contenido['nivel'] }}</p>
      <p class="mb-2"><span class="font-bold">Clase:</span> {{ contenido['clase'] }}</p>
    </div>

    <!-- Datos adicionales (siempre visibles) -->
    <div class="mb-6">
      <h2 class="text-2xl font-semibold border-b pb-2 mb-4">Datos adicionales</h2>
      <p class="mb-2"><span class="font-bold">Vida:</span> {{ contenido['vida']['actual'] }} / {{ contenido['vida']['maxima'] }}</p>
      <p class="mb-2"><span class="font-bold">Mana:</span> {{ contenido['mana']['actual'] }} / {{ contenido['mana']['maximo'] }}</p>
      <p class="mb-2"><span class="font-bold">Resistencia:</span> {{ contenido['resistencia']['actual'] }} / {{ contenido['resistencia']['maxima'] }}</p>
      <p class="mb-2"><span class="font-bold">Sobre carga:</span> {{ contenido['sobrecarga'] }}</p>
      <p class="mb-2"><span class="font-bold">Velocidad:</span> {{ contenido['velocidad'] }}</p>
      <p class="mb-2"><span class="font-bold">Tiradas:</span> Éxitos: {{ contenido['tiradas']['exitos'] }}, Fallos: {{ contenido['tiradas']['fallos'] }}</p>
    </div>

    <!-- Dinero (siempre visible) -->
    <div class="mb-6">
      <h2 class="text-2xl font-semibold border-b pb-2 mb-4">Dinero</h2>
      <p class="mb-2"><span class="font-bold">Cobre:</span> {{ contenido['dinero'][0] }}</p>
      <p class="mb-2"><span class="font-bold">Plata:</span> {{ contenido['dinero'][1] }}</p>
      <p class="mb-2"><span class="font-bold">Oro:</span> {{ contenido['dinero'][2] }}</p>
      <p class="mb-2"><span class="font-bold">Platino:</span> {{ contenido['dinero'][3] }}</p>
    </div>

    <!-- Barra de navegación de secciones usando radio-inputs -->
    <div class="flex justify-center mb-6">
      <div class="radio-inputs">
        <label class="radio">
          <input type="radio" name="secciones" onclick="mostrarSeccion('seccionDestrezas')" checked>
          <span class="name">Destrezas</span>
        </label>
        <label class="radio">
          <input type="radio" name="secciones" onclick="mostrarSeccion('seccionEstadisticas')">
          <span class="name">Estadísticas</span>
        </label>
        <label class="radio">
          <input type="radio" name="secciones" onclick="mostrarSeccion('seccionInventarioEquipo')">
          <span class="name">Inventario y Equipo</span>
        </label>
        <label class="radio">
          <input type="radio" name="secciones" onclick="mostrarSeccion('seccionHabilidadesHechizos')">
          <span class="name">Habilidades y Hechizos</span>
        </label>
        <label class="radio">
          <input type="radio" name="secciones" onclick="mostrarSeccion('seccionDistraccion')">
          <span class="name">TDAH</span>
        </label>
      </div>
    </div>

    <!-- Sección: Destrezas -->
    <div id="seccionDestrezas" class="seccion">
      <h2 class="text-2xl font-semibold border-b pb-2 mb-4">Destrezas</h2>
      <ul class="list-disc pl-5">
        {% set destrezas_nombres = ['Minería', 'Herrería', 'Costura', 'Carpintería', 
                                  'Arcano', 'Supervivencia', 'Pesca', 'Alquimia', 
                                  'Cocina', 'Medicina', 'Sigilo', 'Arco', 
                                  'Espada', 'Bloqueo', 'Engaño', 'Percepción'] %}
        {% for valor in contenido['destrezas'] %}
          <li class="mb-1">
            <span class="font-bold">{{ destrezas_nombres[loop.index0] }}:</span> {{ valor }}
          </li>
        {% endfor %}
      </ul>
    </div>

    <!-- Sección: Estadísticas -->
    <div id="seccionEstadisticas" class="seccion hidden">
      <h2 class="text-2xl font-semibold border-b pb-2 mb-4">Estadísticas</h2>
      <ul class="list-disc pl-5">
        {% set estadisticas_nombres = ['Fuerza', 'Resistencia', 'Agilidad', 
                                      'Poder', 'Control', 'Capacidad', 
                                      'Carisma', 'Inteligencia', 'Sabiduría'] %}
        {% for valor in contenido['estadisticas'] %}
          <li class="mb-1">
            <span class="font-bold">{{ estadisticas_nombres[loop.index0] }}:</span> {{ valor }}
          </li>
        {% endfor %}
      </ul>
    </div>

    <!-- Sección: Inventario y Equipo (se agrupan Equipo e Inventario) -->
    <div id="seccionInventarioEquipo" class="seccion hidden">
      <h2 class="text-2xl font-semibold border-b pb-2 mb-4">Inventario y Equipo</h2>
      
      <!-- Equipo -->
      <h3 class="text-xl font-semibold mt-4">Equipo</h3>
      {% if contenido['equipamiento'] %}
        <ul class="list-disc pl-5 space-y-2">
          {% for item in contenido['equipamiento'] %}
            <li class="mb-1">
              <div class="relative group inline-block">
                <span class="cursor-pointer text-blue-600 hover:underline">{{ item }}</span>
                <div class="absolute left-1/2 bottom-full transform -translate-x-1/2 mb-2 hidden group-hover:block w-72 bg-gray-800 text-white text-xs rounded py-2 px-3 z-10">
                  {% for arma in armas_detalle %}
                    {% if arma['nombre'] == item %}
                      <p><strong>Daño:</strong> {{ arma['daño'] }}</p>
                      <p><strong>Calidad:</strong> {{ arma['calidad'] }}</p>
                      <p><strong>Tipo:</strong> {{ arma['tipo'] }}</p>
                      <p><strong>Descripción:</strong> {{ arma['descripcion'] }}</p>
                    {% endif %}
                  {% endfor %}
                  {% for armadura in armaduras_detalle %}
                    {% if armadura['nombre'] == item %}
                      <p><strong>Rating:</strong> {{ armadura['rating'] }}</p>
                      <p><strong>Calidad:</strong> {{ armadura['calidad'] }}</p>
                      <p><strong>Tipo:</strong> {{ armadura['tipo'] }}</p>
                      <p><strong>Descripción:</strong> {{ armadura['descripcion'] }}</p>
                    {% endif %}
                  {% endfor %}
                  {% for objeto in objetos_detalle %}
                    {% if objeto['nombre'] == item %}
                      <p><strong>Otros:</strong> {{ objeto['otros'] }}</p>
                      <p><strong>Tipo:</strong> {{ objeto['tipo'] }}</p>
                      <p><strong>Descripción:</strong> {{ objeto['descripcion'] }}</p>
                    {% endif %}
                  {% endfor %}
                </div>
              </div>
            </li>
          {% endfor %}
        </ul>
      {% else %}
        <p>No hay equipo registrado.</p>
      {% endif %}

      <!-- Inventario -->
      <h3 class="text-xl font-semibold mt-4">Inventario</h3>
      {% if contenido['objetos'] %}
        <ul class="list-disc pl-5 space-y-2">
          {% for item in contenido['objetos'] %}
            <li class="mb-1">
              <div class="relative group inline-block">
                <span class="cursor-pointer text-blue-600 hover:underline">{{ item }}</span>
                <div class="absolute left-1/2 bottom-full transform -translate-x-1/2 mb-2 hidden group-hover:block w-72 bg-gray-800 text-white text-xs rounded py-2 px-3 z-10">
                  {% for objeto in objetos_detalle %}
                    {% if objeto['nombre'] == item %}
                      <p><strong>{{ objeto['nombre'] }}</strong></p>
                      <p><strong>Otros:</strong> {{ objeto['otros'] }}</p>
                      <p><strong>Descripción:</strong> {{ objeto['descripcion'] }}</p>
                    {% endif %}
                  {% endfor %}
                  {% for arma in armas_detalle %}
                    {% if arma['nombre'] == item %}
                      <p><strong>{{ arma['nombre'] }}</strong></p>
                      <p><strong>Daño:</strong> {{ arma['daño'] }}</p>
                      <p><strong>Calidad:</strong> {{ arma['calidad'] }}</p>
                      <p><strong>Tipo:</strong> {{ arma['tipo'] }}</p>
                      <p><strong>Descripción:</strong> {{ arma['descripcion'] }}</p>
                    {% endif %}
                  {% endfor %}
                  {% for armadura in armaduras_detalle %}
                    {% if armadura['nombre'] == item %}
                      <p><strong>{{ armadura['nombre'] }}</strong></p>
                      <p><strong>Rating:</strong> {{ armadura['rating'] }}</p>
                      <p><strong>Calidad:</strong> {{ armadura['calidad'] }}</p>
                      <p><strong>Tipo:</strong> {{ armadura['tipo'] }}</p>
                      <p><strong>Descripción:</strong> {{ armadura['descripcion'] }}</p>
                    {% endif %}
                  {% endfor %}
                </div>
              </div>
            </li>
          {% endfor %}
        </ul>
      {% else %}
        <p>No hay objetos en el inventario.</p>
      {% endif %}
    </div>

    <!-- Sección: Habilidades y Hechizos (se agrupan ambos bloques) -->
    <div id="seccionHabilidadesHechizos" class="seccion hidden">
      <h2 class="text-2xl font-semibold border-b pb-2 mb-4">Habilidades y Hechizos</h2>
      
      <!-- Habilidades -->
      <h3 class="text-xl font-semibold mt-4">Habilidades</h3>
      {% if contenido['habilidades'] %}
        <ul class="list-disc pl-5 space-y-2">
          {% for habilidad in contenido['habilidades'] %}
            {% if habilidad in habilidades_detalle %}
              <li>
                <div class="relative group inline-block">
                  <span class="cursor-pointer text-blue-600 hover:underline">{{ habilidad }}</span>
                  <div class="absolute left-1/2 bottom-full transform -translate-x-1/2 mb-2 hidden group-hover:block w-64 bg-gray-800 text-white text-xs rounded py-2 px-3 z-10">
                    <p><strong>Duración:</strong> {{ habilidades_detalle[habilidad]['duracion'].strip('"') }}</p>
                    <p><strong>Coste de vida:</strong> {{ habilidades_detalle[habilidad]['coste'].split(',')[0].strip('"') }}</p>
                    <p><strong>Coste de mana:</strong> {{ habilidades_detalle[habilidad]['coste'].split(',')[1].strip('"') }}</p>
                    <p><strong>Coste de resistencia:</strong> {{ habilidades_detalle[habilidad]['coste'].split(',')[2].strip('"') }}</p>
                    <p><strong>Rango:</strong> {{ habilidades_detalle[habilidad]['rango'] }}ft</p>
                    {% if habilidades_detalle[habilidad]['clase'] %}
                      <p><strong>Clase:</strong> {{ habilidades_detalle[habilidad]['clase'] }}</p>
                    {% endif %}
                    {% if habilidades_detalle[habilidad]['raza'] %}
                      <p><strong>Raza:</strong> {{ habilidades_detalle[habilidad]['raza'] }}</p>
                    {% endif %}
                    {% if habilidades_detalle[habilidad]['otro'] %}
                      <p><strong>Otro:</strong> {{ habilidades_detalle[habilidad]['otro'] }}</p>
                    {% endif %}
                    <p><strong>Casteo:</strong> {{ habilidades_detalle[habilidad]['casteo'].strip('"') }}</p>
                    <p class="mt-2">{{ habilidades_detalle[habilidad]['descripcion'].strip('"') }}</p>
                  </div>
                </div>
              </li>
            {% endif %}
          {% endfor %}
        </ul>
      {% else %}
        <p>No hay habilidades registradas.</p>
      {% endif %}
      
      <!-- Hechizos -->
      <h3 class="text-xl font-semibold mt-4">Hechizos</h3>
      {% if contenido['hechizos'] %}
        <ul class="list-disc pl-5 space-y-2">
          {% for hechizo in contenido['hechizos'] %}
            {% if hechizo in hechizos_detalle %}
              <li>
                <div class="relative group inline-block">
                  <span class="cursor-pointer text-blue-600 hover:underline">{{ hechizo }}</span>
                  <div class="absolute left-1/2 bottom-full transform -translate-x-1/2 mb-2 hidden group-hover:block w-64 bg-gray-800 text-white text-xs rounded py-2 px-3 z-10">
                    <p><strong>Nivel:</strong> {{ hechizos_detalle[hechizo]['nivel'] }}</p>
                    <p><strong>Magia:</strong> {{ hechizos_detalle[hechizo]['magia'] }}</p>
                    <p><strong>Coste:</strong> {{ hechizos_detalle[hechizo]['coste'] }}</p>
                    <p><strong>Rango:</strong> {{ hechizos_detalle[hechizo]['rango'] }}ft</p>
                    <p><strong>Duración:</strong> {{ hechizos_detalle[hechizo]['duracion'] }}</p>
                    <p><strong>Casteo:</strong> {{ hechizos_detalle[hechizo]['casteo'] }}</p>
                    <p class="mt-2">{{ hechizos_detalle[hechizo]['descripcion'] }}</p>
                  </div>
                </div>
              </li>
            {% endif %}
          {% endfor %}
        </ul>
      {% else %}
        <p>No hay hechizos registrados.</p>
      {% endif %}
    </div>

    <div id="seccionDistraccion" class="seccion hidden">

    </div>

    <!-- Historia y Foto (siempre visibles) -->
    <div class="mb-6 flex items-start space-x-6">
      <!-- Historia -->
      <div class="flex-1">
        <h2 class="text-2xl font-semibold border-b pb-2 mb-4">Historia</h2>
        <p>{{ contenido['historia'] }}</p>
      </div>
      <!-- Foto -->
      <div class="w-1/4">
        {% if contenido['foto'] %}
          <h2 class="text-2xl font-semibold border-b pb-2 mb-4">Foto</h2>
          <img src="{{ url_for('serve_photo', filename=contenido['foto']) }}" alt="Foto del personaje" class="w-full h-auto rounded-md" />
        {% else %}
          <p>No hay foto disponible.</p>
        {% endif %}
      </div>
    </div>

    <!-- Enlaces para volver o editar -->
    <div class="text-center">
      <a href="{{ url_for('fichas') }}" class="text-blue-500 hover:underline">
        Volver a la lista de fichas
      </a>
      <a href="{{ url_for('modificar_ficha', nombre_ficha=nombre_ficha) }}" class="text-blue-500 hover:underline ml-4">
        Editar ficha
      </a>
    </div>
  </div>

  <!-- JavaScript para cambiar de sección -->
  <script>
    function mostrarSeccion(id) {
      document.querySelectorAll('.seccion').forEach(function(seccion) {
        seccion.classList.add('hidden');
      });
      document.getElementById(id).classList.remove('hidden');
    }
  </script>
  
  <!-- Si tienes un archivo JS externo, puedes enlazarlo aquí -->
  <script src="{{ url_for('static', filename='js/ver_fichas.js') }}"></script>
</body>
</html>
